import{i as se}from"./index-c14b60e2.js";import{T as ue,B as H}from"./TableAction-45c049b5.js";import{c as le,s as de}from"./index-cc631905.js";import{l as ce}from"./vendor-ec30964e.js";import{_ as A,T as C,B,p as L,a as b,c as he,b as pe,i as fe,d as ve,g as me,P as ye,G as ge,R as xe,f as Te,C as Ne,S as we,u as k,e as Se,h as Ie,H as De,s as Ce,j as Ae,k as _e,l as Ve,m as Be,r as R,n as Pe,o as D,q as P,t as Ee,v as ae,w as Fe,x as Le,y as be,z as ke,A as Re,D as ze,E as Me,F as Xe,M as Ze,I as Ge,J as Ye,K as $e,L as W,N as Oe,O as He,Q as We,U as je,V as Ue,W as qe,X as Je}from"./installCanvasRenderer-cb1ba546.js";import{i as Ke}from"./install-40c3b04b.js";var j=b,Qe=function(a){A(t,a);function t(e){var r=a.call(this)||this;return r.type="view",r.dimensions=["x","y"],r._roamTransformable=new C,r._rawTransformable=new C,r.name=e,r}return t.prototype.setBoundingRect=function(e,r,n,o){return this._rect=new B(e,r,n,o),this._rect},t.prototype.getBoundingRect=function(){return this._rect},t.prototype.setViewRect=function(e,r,n,o){this._transformTo(e,r,n,o),this._viewRect=new B(e,r,n,o)},t.prototype._transformTo=function(e,r,n,o){var i=this.getBoundingRect(),s=this._rawTransformable;s.transform=i.calculateTransform(new B(e,r,n,o));var c=s.parent;s.parent=null,s.decomposeTransform(),s.parent=c,this._updateTransform()},t.prototype.setCenter=function(e,r){e&&(this._center=[L(e[0],r.getWidth()),L(e[1],r.getHeight())],this._updateCenterAndZoom())},t.prototype.setZoom=function(e){e=e||1;var r=this.zoomLimit;r&&(r.max!=null&&(e=Math.min(r.max,e)),r.min!=null&&(e=Math.max(r.min,e))),this._zoom=e,this._updateCenterAndZoom()},t.prototype.getDefaultCenter=function(){var e=this.getBoundingRect(),r=e.x+e.width/2,n=e.y+e.height/2;return[r,n]},t.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},t.prototype.getZoom=function(){return this._zoom||1},t.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},t.prototype._updateCenterAndZoom=function(){var e=this._rawTransformable.getLocalTransform(),r=this._roamTransformable,n=this.getDefaultCenter(),o=this.getCenter(),i=this.getZoom();o=b([],o,e),n=b([],n,e),r.originX=o[0],r.originY=o[1],r.x=n[0]-o[0],r.y=n[1]-o[1],r.scaleX=r.scaleY=i,this._updateTransform()},t.prototype._updateTransform=function(){var e=this._roamTransformable,r=this._rawTransformable;r.parent=e,e.updateTransform(),r.updateTransform(),he(this.transform||(this.transform=[]),r.transform||pe()),this._rawTransform=r.getLocalTransform(),this.invTransform=this.invTransform||[],fe(this.invTransform,this.transform),this.decomposeTransform()},t.prototype.getTransformInfo=function(){var e=this._rawTransformable,r=this._roamTransformable,n=new C;return n.transform=r.transform,n.decomposeTransform(),{roam:{x:n.x,y:n.y,scaleX:n.scaleX,scaleY:n.scaleY},raw:{x:e.x,y:e.y,scaleX:e.scaleX,scaleY:e.scaleY}}},t.prototype.getViewRect=function(){return this._viewRect},t.prototype.getViewRectAfterRoam=function(){var e=this.getBoundingRect().clone();return e.applyTransform(this.transform),e},t.prototype.dataToPoint=function(e,r,n){var o=r?this._rawTransform:this.transform;return n=n||[],o?j(n,e,o):ve(n,e)},t.prototype.pointToData=function(e){var r=this.invTransform;return r?j([],e,r):[e[0],e[1]]},t.prototype.convertToPixel=function(e,r,n){var o=U(r);return o===this?o.dataToPoint(n):null},t.prototype.convertFromPixel=function(e,r,n){var o=U(r);return o===this?o.pointToData(n):null},t.prototype.containPoint=function(e){return this.getViewRectAfterRoam().contain(e[0],e[1])},t.dimensions=["x","y"],t}(C);function U(a){var t=a.seriesModel;return t?t.coordinateSystem:null}const et=Qe;function q(a,t){return a.pointToProjected?a.pointToProjected(t):a.pointToData(t)}function tt(a,t,e,r){var n=a.getZoom(),o=a.getCenter(),i=t.zoom,s=a.projectedToPoint?a.projectedToPoint(o):a.dataToPoint(o);if(t.dx!=null&&t.dy!=null&&(s[0]-=t.dx,s[1]-=t.dy,a.setCenter(q(a,s),r)),i!=null){if(e){var c=e.min||0,u=e.max||1/0;i=Math.max(Math.min(n*i,u),c)/n}a.scaleX*=i,a.scaleY*=i;var l=(t.originX-a.x)*(i-1),h=(t.originY-a.y)*(i-1);a.x-=l,a.y-=h,a.updateTransform(),a.setCenter(q(a,s),r),a.setZoom(i*n)}return{center:a.getCenter(),zoom:a.getZoom()}}function at(a,t,e){var r=a.target;r.x+=t,r.y+=e,r.dirty()}function rt(a,t,e,r){var n=a.target,o=a.zoomLimit,i=a.zoom=a.zoom||1;if(i*=t,o){var s=o.min||0,c=o.max||1/0;i=Math.max(Math.min(c,i),s)}var u=i/a.zoom;a.zoom=i,n.x-=(e-n.x)*(u-1),n.y-=(r-n.y)*(u-1),n.scaleX*=u,n.scaleY*=u,n.dirty()}var nt={axisPointer:1,tooltip:1,brush:1};function it(a,t,e){var r=t.getComponentByElement(a.topTarget),n=r&&r.coordinateSystem;return r&&r!==e&&!nt.hasOwnProperty(r.mainType)&&n&&n.model!==e}function ot(a){var t=a;t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var e=[t],r,n;r=e.pop();)if(n=r.children,r.isExpand&&n.length)for(var o=n.length,i=o-1;i>=0;i--){var s=n[i];s.hierNode={defaultAncestor:null,ancestor:s,prelim:0,modifier:0,change:0,shift:0,i,thread:null},e.push(s)}}function st(a,t){var e=a.isExpand?a.children:[],r=a.parentNode.children,n=a.hierNode.i?r[a.hierNode.i-1]:null;if(e.length){dt(a);var o=(e[0].hierNode.prelim+e[e.length-1].hierNode.prelim)/2;n?(a.hierNode.prelim=n.hierNode.prelim+t(a,n),a.hierNode.modifier=a.hierNode.prelim-o):a.hierNode.prelim=o}else n&&(a.hierNode.prelim=n.hierNode.prelim+t(a,n));a.parentNode.hierNode.defaultAncestor=ct(a,n,a.parentNode.hierNode.defaultAncestor||r[0],t)}function ut(a){var t=a.hierNode.prelim+a.parentNode.hierNode.modifier;a.setLayout({x:t},!0),a.hierNode.modifier+=a.parentNode.hierNode.modifier}function J(a){return arguments.length?a:ft}function I(a,t){return a-=Math.PI/2,{x:t*Math.cos(a),y:t*Math.sin(a)}}function lt(a,t){return me(a.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function dt(a){for(var t=a.children,e=t.length,r=0,n=0;--e>=0;){var o=t[e];o.hierNode.prelim+=r,o.hierNode.modifier+=r,n+=o.hierNode.change,r+=o.hierNode.shift+n}}function ct(a,t,e,r){if(t){for(var n=a,o=a,i=o.parentNode.children[0],s=t,c=n.hierNode.modifier,u=o.hierNode.modifier,l=i.hierNode.modifier,h=s.hierNode.modifier;s=E(s),o=F(o),s&&o;){n=E(n),i=F(i),n.hierNode.ancestor=a;var d=s.hierNode.prelim+h-o.hierNode.prelim-u+r(s,o);d>0&&(pt(ht(s,a,e),a,d),u+=d,c+=d),h+=s.hierNode.modifier,u+=o.hierNode.modifier,c+=n.hierNode.modifier,l+=i.hierNode.modifier}s&&!E(n)&&(n.hierNode.thread=s,n.hierNode.modifier+=h-c),o&&!F(i)&&(i.hierNode.thread=o,i.hierNode.modifier+=u-l,e=a)}return e}function E(a){var t=a.children;return t.length&&a.isExpand?t[t.length-1]:a.hierNode.thread}function F(a){var t=a.children;return t.length&&a.isExpand?t[0]:a.hierNode.thread}function ht(a,t,e){return a.hierNode.ancestor.parentNode===t.parentNode?a.hierNode.ancestor:e}function pt(a,t,e){var r=e/(t.hierNode.i-a.hierNode.i);t.hierNode.change-=r,t.hierNode.shift+=e,t.hierNode.modifier+=e,t.hierNode.prelim+=e,a.hierNode.change+=r}function ft(a,t){return a.parentNode===t.parentNode?1:2}var vt=function(){function a(){this.parentPoint=[],this.childPoints=[]}return a}(),mt=function(a){A(t,a);function t(e){return a.call(this,e)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new vt},t.prototype.buildPath=function(e,r){var n=r.childPoints,o=n.length,i=r.parentPoint,s=n[0],c=n[o-1];if(o===1){e.moveTo(i[0],i[1]),e.lineTo(s[0],s[1]);return}var u=r.orient,l=u==="TB"||u==="BT"?0:1,h=1-l,d=L(r.forkPosition,1),f=[];f[l]=i[l],f[h]=i[h]+(c[h]-i[h])*d,e.moveTo(i[0],i[1]),e.lineTo(f[0],f[1]),e.moveTo(s[0],s[1]),f[l]=s[l],e.lineTo(f[0],f[1]),f[l]=c[l],e.lineTo(f[0],f[1]),e.lineTo(c[0],c[1]);for(var v=1;v<o-1;v++){var p=n[v];e.moveTo(p[0],p[1]),f[l]=p[l],e.lineTo(f[0],f[1])}},t}(ye),yt=function(a){A(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.type=t.type,e._mainGroup=new ge,e}return t.prototype.init=function(e,r){this._controller=new xe(r.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},t.prototype.render=function(e,r,n){var o=e.getData(),i=e.layoutInfo,s=this._mainGroup,c=e.get("layout");c==="radial"?(s.x=i.x+i.width/2,s.y=i.y+i.height/2):(s.x=i.x,s.y=i.y),this._updateViewCoordSys(e,n),this._updateController(e,r,n);var u=this._data;o.diff(u).add(function(l){K(o,l)&&Q(o,l,null,s,e)}).update(function(l,h){var d=u.getItemGraphicEl(h);if(!K(o,l)){d&&te(u,h,d,s,e);return}Q(o,l,d,s,e)}).remove(function(l){var h=u.getItemGraphicEl(l);h&&te(u,l,h,s,e)}).execute(),this._nodeScaleRatio=e.get("nodeScaleRatio"),this._updateNodeAndLinkScale(e),e.get("expandAndCollapse")===!0&&o.eachItemGraphicEl(function(l,h){l.off("click").on("click",function(){n.dispatchAction({type:"treeExpandAndCollapse",seriesId:e.id,dataIndex:h})})}),this._data=o},t.prototype._updateViewCoordSys=function(e,r){var n=e.getData(),o=[];n.each(function(h){var d=n.getItemLayout(h);d&&!isNaN(d.x)&&!isNaN(d.y)&&o.push([+d.x,+d.y])});var i=[],s=[];Te(o,i,s);var c=this._min,u=this._max;s[0]-i[0]===0&&(i[0]=c?c[0]:i[0]-1,s[0]=u?u[0]:s[0]+1),s[1]-i[1]===0&&(i[1]=c?c[1]:i[1]-1,s[1]=u?u[1]:s[1]+1);var l=e.coordinateSystem=new et;l.zoomLimit=e.get("scaleLimit"),l.setBoundingRect(i[0],i[1],s[0]-i[0],s[1]-i[1]),l.setCenter(e.get("center"),r),l.setZoom(e.get("zoom")),this.group.attr({x:l.x,y:l.y,scaleX:l.scaleX,scaleY:l.scaleY}),this._min=i,this._max=s},t.prototype._updateController=function(e,r,n){var o=this,i=this._controller,s=this._controllerHost,c=this.group;i.setPointerChecker(function(u,l,h){var d=c.getBoundingRect();return d.applyTransform(c.transform),d.contain(l,h)&&!it(u,n,e)}),i.enable(e.get("roam")),s.zoomLimit=e.get("scaleLimit"),s.zoom=e.coordinateSystem.getZoom(),i.off("pan").off("zoom").on("pan",function(u){at(s,u.dx,u.dy),n.dispatchAction({seriesId:e.id,type:"treeRoam",dx:u.dx,dy:u.dy})}).on("zoom",function(u){rt(s,u.scale,u.originX,u.originY),n.dispatchAction({seriesId:e.id,type:"treeRoam",zoom:u.scale,originX:u.originX,originY:u.originY}),o._updateNodeAndLinkScale(e),n.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(e){var r=e.getData(),n=this._getNodeGlobalScale(e);r.eachItemGraphicEl(function(o,i){o.setSymbolScale(n)})},t.prototype._getNodeGlobalScale=function(e){var r=e.coordinateSystem;if(r.type!=="view")return 1;var n=this._nodeScaleRatio,o=r.scaleX||1,i=r.getZoom(),s=(i-1)*n+1;return s/o},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},t.type="tree",t}(Ne);function K(a,t){var e=a.getItemLayout(t);return e&&!isNaN(e.x)&&!isNaN(e.y)}function Q(a,t,e,r,n){var o=!e,i=a.tree.getNodeByDataIndex(t),s=i.getModel(),c=i.getVisual("style").fill,u=i.isExpand===!1&&i.children.length!==0?c:"#fff",l=a.tree.root,h=i.parentNode===l?i:i.parentNode||i,d=a.getItemGraphicEl(h.dataIndex),f=h.getLayout(),v=d?{x:d.__oldX,y:d.__oldY,rawX:d.__radialOldRawX,rawY:d.__radialOldRawY}:f,p=i.getLayout();o?(e=new we(a,t,null,{symbolInnerColor:u,useNameLabel:!0}),e.x=v.x,e.y=v.y):e.updateData(a,t,null,{symbolInnerColor:u,useNameLabel:!0}),e.__radialOldRawX=e.__radialRawX,e.__radialOldRawY=e.__radialRawY,e.__radialRawX=p.rawX,e.__radialRawY=p.rawY,r.add(e),a.setItemGraphicEl(t,e),e.__oldX=e.x,e.__oldY=e.y,k(e,{x:p.x,y:p.y},n);var y=e.getSymbolPath();if(n.get("layout")==="radial"){var T=l.children[0],x=T.getLayout(),m=T.children.length,g=void 0,w=void 0;if(p.x===x.x&&i.isExpand===!0&&T.children.length){var _={x:(T.children[0].getLayout().x+T.children[m-1].getLayout().x)/2,y:(T.children[0].getLayout().y+T.children[m-1].getLayout().y)/2};g=Math.atan2(_.y-x.y,_.x-x.x),g<0&&(g=Math.PI*2+g),w=_.x<x.x,w&&(g=g-Math.PI)}else g=Math.atan2(p.y-x.y,p.x-x.x),g<0&&(g=Math.PI*2+g),i.children.length===0||i.children.length!==0&&i.isExpand===!1?(w=p.x<x.x,w&&(g=g-Math.PI)):(w=p.x>x.x,w||(g=g-Math.PI));var ie=w?"left":"right",X=s.getModel("label"),Z=X.get("rotate"),oe=Z*(Math.PI/180),G=y.getTextContent();G&&(y.setTextConfig({position:X.get("position")||ie,rotation:Z==null?-g:oe,origin:"center"}),G.setStyle("verticalAlign","middle"))}var V=s.get(["emphasis","focus"]),Y=V==="relative"?Se(i.getAncestorsIndices(),i.getDescendantIndices()):V==="ancestor"?i.getAncestorsIndices():V==="descendant"?i.getDescendantIndices():null;Y&&(Ie(e).focus=Y),gt(n,i,l,e,v,f,p,r),e.__edge&&(e.onHoverStateChange=function($){if($!=="blur"){var O=i.parentNode&&a.getItemGraphicEl(i.parentNode.dataIndex);O&&O.hoverState===De||Ce(e.__edge,$)}})}function gt(a,t,e,r,n,o,i,s){var c=t.getModel(),u=a.get("edgeShape"),l=a.get("layout"),h=a.getOrient(),d=a.get(["lineStyle","curveness"]),f=a.get("edgeForkPosition"),v=c.getModel("lineStyle").getLineStyle(),p=r.__edge;if(u==="curve")t.parentNode&&t.parentNode!==e&&(p||(p=r.__edge=new Ae({shape:z(l,h,d,n,n)})),k(p,{shape:z(l,h,d,o,i)},a));else if(u==="polyline"&&l==="orthogonal"&&t!==e&&t.children&&t.children.length!==0&&t.isExpand===!0){for(var y=t.children,T=[],x=0;x<y.length;x++){var m=y[x].getLayout();T.push([m.x,m.y])}p||(p=r.__edge=new mt({shape:{parentPoint:[i.x,i.y],childPoints:[[i.x,i.y]],orient:h,forkPosition:f}})),k(p,{shape:{parentPoint:[i.x,i.y],childPoints:T}},a)}p&&!(u==="polyline"&&!t.isExpand)&&(p.useStyle(_e({strokeNoScale:!0,fill:null},v)),Ve(p,c,"lineStyle"),Be(p),s.add(p))}function ee(a,t,e,r,n){var o=t.tree.root,i=re(o,a),s=i.source,c=i.sourceLayout,u=t.getItemGraphicEl(a.dataIndex);if(u){var l=t.getItemGraphicEl(s.dataIndex),h=l.__edge,d=u.__edge||(s.isExpand===!1||s.children.length===1?h:void 0),f=r.get("edgeShape"),v=r.get("layout"),p=r.get("orient"),y=r.get(["lineStyle","curveness"]);d&&(f==="curve"?R(d,{shape:z(v,p,y,c,c),style:{opacity:0}},r,{cb:function(){e.remove(d)},removeOpt:n}):f==="polyline"&&r.get("layout")==="orthogonal"&&R(d,{shape:{parentPoint:[c.x,c.y],childPoints:[[c.x,c.y]]},style:{opacity:0}},r,{cb:function(){e.remove(d)},removeOpt:n}))}}function re(a,t){for(var e=t.parentNode===a?t:t.parentNode||t,r;r=e.getLayout(),r==null;)e=e.parentNode===a?e:e.parentNode||e;return{source:e,sourceLayout:r}}function te(a,t,e,r,n){var o=a.tree.getNodeByDataIndex(t),i=a.tree.root,s=re(i,o).sourceLayout,c={duration:n.get("animationDurationUpdate"),easing:n.get("animationEasingUpdate")};R(e,{x:s.x+1,y:s.y+1},n,{cb:function(){r.remove(e),a.setItemGraphicEl(t,null)},removeOpt:c}),e.fadeOut(null,a.hostModel,{fadeLabel:!0,animation:c}),o.children.forEach(function(u){ee(u,a,r,n,c)}),ee(o,a,r,n,c)}function z(a,t,e,r,n){var o,i,s,c,u,l,h,d;if(a==="radial"){u=r.rawX,h=r.rawY,l=n.rawX,d=n.rawY;var f=I(u,h),v=I(u,h+(d-h)*e),p=I(l,d+(h-d)*e),y=I(l,d);return{x1:f.x||0,y1:f.y||0,x2:y.x||0,y2:y.y||0,cpx1:v.x||0,cpy1:v.y||0,cpx2:p.x||0,cpy2:p.y||0}}else u=r.x,h=r.y,l=n.x,d=n.y,(t==="LR"||t==="RL")&&(o=u+(l-u)*e,i=h,s=l+(u-l)*e,c=d),(t==="TB"||t==="BT")&&(o=u,i=h+(d-h)*e,s=l,c=d+(h-d)*e);return{x1:u,y1:h,x2:l,y2:d,cpx1:o,cpy1:i,cpx2:s,cpy2:c}}const xt=yt;var N=Pe();function Tt(a){var t=a.mainData,e=a.datas;e||(e={main:t},a.datasAttr={main:"data"}),a.datas=a.mainData=null,ne(t,e,a),D(e,function(r){D(t.TRANSFERABLE_METHODS,function(n){r.wrapMethod(n,P(Nt,a))})}),t.wrapMethod("cloneShallow",P(St,a)),D(t.CHANGABLE_METHODS,function(r){t.wrapMethod(r,P(wt,a))}),Ee(e[t.dataType]===t)}function Nt(a,t){if(Ct(this)){var e=ae({},N(this).datas);e[this.dataType]=t,ne(t,e,a)}else M(t,this.dataType,N(this).mainData,a);return t}function wt(a,t){return a.struct&&a.struct.update(),t}function St(a,t){return D(N(t).datas,function(e,r){e!==t&&M(e.cloneShallow(),r,t,a)}),t}function It(a){var t=N(this).mainData;return a==null||t==null?t:N(t).datas[a]}function Dt(){var a=N(this).mainData;return a==null?[{data:a}]:Fe(Le(N(a).datas),function(t){return{type:t,data:N(a).datas[t]}})}function Ct(a){return N(a).mainData===a}function ne(a,t,e){N(a).datas={},D(t,function(r,n){M(r,n,a,e)})}function M(a,t,e,r){N(e).datas[t]=a,N(a).mainData=e,a.dataType=t,r.struct&&(a[r.structAttr]=r.struct,r.struct[r.datasAttr[t]]=a),a.getLinkedData=It,a.getLinkedDataAll=Dt}var At=function(){function a(t,e){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=e}return a.prototype.isRemoved=function(){return this.dataIndex<0},a.prototype.eachNode=function(t,e,r){Me(t)&&(r=e,e=t,t=null),t=t||{},Xe(t)&&(t={order:t});var n=t.order||"preorder",o=this[t.attr||"children"],i;n==="preorder"&&(i=e.call(r,this));for(var s=0;!i&&s<o.length;s++)o[s].eachNode(t,e,r);n==="postorder"&&e.call(r,this)},a.prototype.updateDepthAndHeight=function(t){var e=0;this.depth=t;for(var r=0;r<this.children.length;r++){var n=this.children[r];n.updateDepthAndHeight(t+1),n.height>e&&(e=n.height)}this.height=e+1},a.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var e=0,r=this.children,n=r.length;e<n;e++){var o=r[e].getNodeById(t);if(o)return o}},a.prototype.contains=function(t){if(t===this)return!0;for(var e=0,r=this.children,n=r.length;e<n;e++){var o=r[e].contains(t);if(o)return o}},a.prototype.getAncestors=function(t){for(var e=[],r=t?this:this.parentNode;r;)e.push(r),r=r.parentNode;return e.reverse(),e},a.prototype.getAncestorsIndices=function(){for(var t=[],e=this;e;)t.push(e.dataIndex),e=e.parentNode;return t.reverse(),t},a.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(e){t.push(e.dataIndex)}),t},a.prototype.getValue=function(t){var e=this.hostTree.data;return e.getStore().get(e.getDimensionIndex(t||"value"),this.dataIndex)},a.prototype.setLayout=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,e)},a.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},a.prototype.getModel=function(t){if(!(this.dataIndex<0)){var e=this.hostTree,r=e.data.getItemModel(this.dataIndex);return r.getModel(t)}},a.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},a.prototype.setVisual=function(t,e){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,e)},a.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},a.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},a.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},a.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,e=0;e<t.length;++e)if(t[e]===this)return e;return-1}return-1},a.prototype.isAncestorOf=function(t){for(var e=t.parentNode;e;){if(e===this)return!0;e=e.parentNode}return!1},a.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},a}(),_t=function(){function a(t){this.type="tree",this._nodes=[],this.hostModel=t}return a.prototype.eachNode=function(t,e,r){this.root.eachNode(t,e,r)},a.prototype.getNodeByDataIndex=function(t){var e=this.data.getRawIndex(t);return this._nodes[e]},a.prototype.getNodeById=function(t){return this.root.getNodeById(t)},a.prototype.update=function(){for(var t=this.data,e=this._nodes,r=0,n=e.length;r<n;r++)e[r].dataIndex=-1;for(var r=0,n=t.count();r<n;r++)e[t.getRawIndex(r)].dataIndex=r},a.prototype.clearLayouts=function(){this.data.clearItemLayouts()},a.createTree=function(t,e,r){var n=new a(e),o=[],i=1;s(t);function s(l,h){var d=l.value;i=Math.max(i,be(d)?d.length:1),o.push(l);var f=new At(ke(l.name,""),n);h?Vt(f,h):n.root=f,n._nodes.push(f);var v=l.children;if(v)for(var p=0;p<v.length;p++)s(v[p],f)}n.root.updateDepthAndHeight(0);var c=Re(o,{coordDimensions:["value"],dimensionsCount:i}).dimensions,u=new ze(c,e);return u.initData(o),r&&r(u),Tt({mainData:u,struct:n,structAttr:"tree"}),n.update(),n},a}();function Vt(a,t){var e=t.children;a.parentNode!==t&&(e.push(a),a.parentNode=t)}const Bt=_t;function Pt(a,t){for(var e=[];a;){var r=a.dataIndex;e.push({name:a.name,dataIndex:r,value:t.getRawValue(r)}),a=a.parentNode}return e.reverse(),e}var Et=function(a){A(t,a);function t(){var e=a!==null&&a.apply(this,arguments)||this;return e.hasSymbolVisual=!0,e.ignoreStyleOnData=!0,e}return t.prototype.getInitialData=function(e){var r={name:e.name,children:e.data},n=e.leaves||{},o=new Ze(n,this,this.ecModel),i=Bt.createTree(r,this,s);function s(h){h.wrapMethod("getItemModel",function(d,f){var v=i.getNodeByDataIndex(f);return v&&v.children.length&&v.isExpand||(d.parentModel=o),d})}var c=0;i.eachNode("preorder",function(h){h.depth>c&&(c=h.depth)});var u=e.expandAndCollapse,l=u&&e.initialTreeDepth>=0?e.initialTreeDepth:c;return i.root.eachNode("preorder",function(h){var d=h.hostTree.data.getRawDataItem(h.dataIndex);h.isExpand=d&&d.collapsed!=null?!d.collapsed:h.depth<=l}),i.data},t.prototype.getOrient=function(){var e=this.get("orient");return e==="horizontal"?e="LR":e==="vertical"&&(e="TB"),e},t.prototype.setZoom=function(e){this.option.zoom=e},t.prototype.setCenter=function(e){this.option.center=e},t.prototype.formatTooltip=function(e,r,n){for(var o=this.getData().tree,i=o.root.children[0],s=o.getNodeByDataIndex(e),c=s.getValue(),u=s.name;s&&s!==i;)u=s.parentNode.name+"."+u,s=s.parentNode;return Ge("nameValue",{name:u,value:c,noValue:isNaN(c)||c==null})},t.prototype.getDataParams=function(e){var r=a.prototype.getDataParams.apply(this,arguments),n=this.getData().tree.getNodeByDataIndex(e);return r.treeAncestors=Pt(n,this),r.collapsed=!n.isExpand,r},t.type="series.tree",t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},t}(Ye);const Ft=Et;function Lt(a,t,e){for(var r=[a],n=[],o;o=r.pop();)if(n.push(o),o.isExpand){var i=o.children;if(i.length)for(var s=0;s<i.length;s++)r.push(i[s])}for(;o=n.pop();)t(o,e)}function S(a,t){for(var e=[a],r;r=e.pop();)if(t(r),r.isExpand){var n=r.children;if(n.length)for(var o=n.length-1;o>=0;o--)e.push(n[o])}}function bt(a,t){a.eachSeriesByType("tree",function(e){kt(e,t)})}function kt(a,t){var e=lt(a,t);a.layoutInfo=e;var r=a.get("layout"),n=0,o=0,i=null;r==="radial"?(n=2*Math.PI,o=Math.min(e.height,e.width)/2,i=J(function(m,g){return(m.parentNode===g.parentNode?1:2)/m.depth})):(n=e.width,o=e.height,i=J());var s=a.getData().tree.root,c=s.children[0];if(c){ot(s),Lt(c,st,i),s.hierNode.modifier=-c.hierNode.prelim,S(c,ut);var u=c,l=c,h=c;S(c,function(m){var g=m.getLayout().x;g<u.getLayout().x&&(u=m),g>l.getLayout().x&&(l=m),m.depth>h.depth&&(h=m)});var d=u===l?1:i(u,l)/2,f=d-u.getLayout().x,v=0,p=0,y=0,T=0;if(r==="radial")v=n/(l.getLayout().x+d+f),p=o/(h.depth-1||1),S(c,function(m){y=(m.getLayout().x+f)*v,T=(m.depth-1)*p;var g=I(y,T);m.setLayout({x:g.x,y:g.y,rawX:y,rawY:T},!0)});else{var x=a.getOrient();x==="RL"||x==="LR"?(p=o/(l.getLayout().x+d+f),v=n/(h.depth-1||1),S(c,function(m){T=(m.getLayout().x+f)*p,y=x==="LR"?(m.depth-1)*v:n-(m.depth-1)*v,m.setLayout({x:y,y:T},!0)})):(x==="TB"||x==="BT")&&(v=n/(l.getLayout().x+d+f),p=o/(h.depth-1||1),S(c,function(m){y=(m.getLayout().x+f)*v,T=x==="TB"?(m.depth-1)*p:o-(m.depth-1)*p,m.setLayout({x:y,y:T},!0)}))}}}function Rt(a){a.eachSeriesByType("tree",function(t){var e=t.getData(),r=e.tree;r.eachNode(function(n){var o=n.getModel(),i=o.getModel("itemStyle").getItemStyle(),s=e.ensureUniqueItemVisual(n.dataIndex,"style");ae(s,i)})})}function zt(a){a.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(t,e){e.eachComponent({mainType:"series",subType:"tree",query:t},function(r){var n=t.dataIndex,o=r.getData().tree,i=o.getNodeByDataIndex(n);i.isExpand=!i.isExpand})}),a.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(t,e,r){e.eachComponent({mainType:"series",subType:"tree",query:t},function(n){var o=n.coordinateSystem,i=tt(o,t,void 0,r);n.setCenter&&n.setCenter(i.center),n.setZoom&&n.setZoom(i.zoom)})})}function Mt(a){a.registerChartView(xt),a.registerSeriesModel(Ft),a.registerLayout(bt),a.registerVisual(Rt),zt(a)}const Xt=(a,t)=>{const e=t.value(0),r=t.coord([t.value(1),e]),o=t.coord([t.value(2),e])[0]-r[0];return{type:"rect",transition:["shape"],shape:{x:r[0],y:r[1],width:o,height:20,r:2},style:{fill:["#5470C6","#91CC75","#EE6666","#FCCE10"][t.value(5)]},emphasis:{style:{stroke:"#000"}},textConfig:{position:"insideLeft"},textContent:{style:{text:t.value(3),fontFamily:"Verdana",fill:"#FFF",width:o-4,overflow:"truncate",ellipsis:"..",truncateMinChar:1},emphasis:{style:{stroke:"#000",lineWidth:.5}}}}};function Zt(a){return{tooltip:{formatter:t=>t.value[4]},dataZoom:[{type:"inside",id:"insideX",xAxisIndex:0,filterMode:"weakFilter",zoomOnMouseWheel:!1,moveOnMouseMove:!0},{id:"dataZoomX",type:"slider",xAxisIndex:0,filterMode:"filter"},{type:"slider",yAxisIndex:0,showDetail:!1},{type:"inside",id:"insideY",yAxisIndex:0,zoomOnMouseWheel:!1,moveOnMouseMove:!0,moveOnMouseWheel:!0}],xAxis:{type:"time",splitLine:{show:!1}},yAxis:{type:"category"},series:[{type:"custom",renderItem:Xt,encode:{x:[1,2],y:0},data:a.map(t=>({value:[t.id,new Date(t.startTime),new Date(t.endTime),`${t.owner} ${t.reason}`,t.description,t.type]}))}]}}function Gt(a){const t=new Map,e=[];return a.forEach(r=>{t.set(r.id,{...r,name:r.owner,value:r.id,children:[]})}),a.forEach(r=>{const n=t.get(r.id);if(r.parentId!==void 0){const o=t.get(r.parentId);o&&o.children.push(n)}else e.push(n)}),console.log(e),e}function Yt(a){return{series:[{type:"tree",data:Gt(a),top:"1%",left:"7%",bottom:"1%",right:"20%",symbolSize:7,label:{position:"left",verticalAlign:"middle",align:"right",fontSize:9},leaves:{label:{position:"right",verticalAlign:"middle",align:"left"}},emphasis:{focus:"descendant"},expandAndCollapse:!0,animationDuration:550,animationDurationUpdate:750}]}}const $t={style:{width:"100%",height:"850px"}},Ot={style:{width:"100%",height:"850px"}},Kt=Vue.defineComponent({setup(a){$e([Mt,Ke,Oe,He,We,je,Ue,qe,Je]);const t=ce().params.id,{t:e}=se.global,r=Vue.ref(),n=Vue.ref(),o=Vue.ref(),i=[{title:e("ID"),key:"id",width:80},{title:e("进程号"),key:"pid",width:100},{title:e("开始时间"),key:"startTime",width:200},{title:e("结束时间"),key:"endTime",width:200},{title:e("启动参数"),key:"args"}],s={width:200,title:e("操作"),key:"action",render(d){return Vue.h(ue,{style:"button",actions:[{label:e("查询任务"),type:"primary",onClick:()=>h(d)}]})}},c=[{title:e("ID"),key:"id",sorter:"default",width:80},{title:e("父级"),key:"parentId",sorter:"default",width:80},{title:e("类型"),key:"type",filter:"default",width:50},{title:e("所属"),key:"owner",filter:"default",width:200},{title:e("开始时间"),key:"startTime",sorter:"default",width:200},{title:e("结束时间"),sorter:"default",key:"endTime",width:200},{title:e("关闭原因"),key:"reason",filter:"default",width:200},{title:e("描述"),key:"description"}],u=Vue.ref();Vue.onMounted(async()=>{u.value=await le()});const l=Vue.ref();async function h(d){l.value=d,r.value=await de(t,{sessionId:d.id}),r.value.unshift({id:0,startTime:d.startTime,endTime:d.endTime,description:d.args,type:2,owner:"root",reason:"exit"}),n.value=Zt(r.value),o.value=Yt(r.value)}return(d,f)=>{const v=Vue.resolveComponent("n-tab-pane"),p=Vue.resolveComponent("n-tabs");return Vue.openBlock(),Vue.createElementBlock("div",null,[Vue.createVNode(p,{type:"line",animated:""},{default:Vue.withCtx(()=>[Vue.createVNode(v,{name:"sessionTable",tab:d.$t("会话历史记录")},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(H),{columns:i,dataSource:u.value,pagination:!1,"row-key":y=>y.id,"scroll-x":1090,actionColumn:s},null,8,["dataSource","row-key"])]),_:1},8,["tab"]),Vue.createVNode(v,{name:"taskTable",tab:d.$t("任务历史记录表")},{default:Vue.withCtx(()=>[Vue.createVNode(Vue.unref(H),{title:l.value.args,columns:c,dataSource:r.value,pagination:!1,"row-key":y=>y.sessionId+"-"+y.id,"scroll-x":1090},null,8,["title","dataSource","row-key"])]),_:1},8,["tab"]),Vue.createVNode(v,{name:"gantt",tab:d.$t("任务历史甘特图")},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",$t,[Vue.createVNode(Vue.unref(W),{class:"chart",option:n.value,autoresize:""},null,8,["option"])])]),_:1},8,["tab"]),Vue.createVNode(v,{name:"tree",tab:d.$t("任务历史树状图")},{default:Vue.withCtx(()=>[Vue.createElementVNode("div",Ot,[Vue.createVNode(Vue.unref(W),{class:"chart",option:o.value,autoresize:""},null,8,["option"])])]),_:1},8,["tab"])]),_:1})])}}});export{Kt as default};
