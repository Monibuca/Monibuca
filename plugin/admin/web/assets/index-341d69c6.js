import{d as _,al as I,U as O,_ as R,$ as i,f as r,u as a,E as p}from"./vue-14860272.js";import{R as g,ai as C,ah as m,V as P,ag as V,a9 as d,aj as y}from"./index-6c19eff1.js";import{u as D}from"./index-79686afe.js";import"./dayjs-4778c158.js";import{_ as w}from"./scroll-tip.vue_vue_type_script_setup_true_lang-612899d3.js";import{d as L}from"./global-1c872f23.js";import{c as B}from"./utils-69111216.js";import{s as M}from"./state-afd218b9.js";import{u as k}from"./usePlay-1a164b06.js";import{S as x}from"./index-f3bf2d11.js";import{C as b}from"./Card-2e616ea4.js";import"./mockjs-890b569b.js";import"./useModal-1fa44c95.js";import"./index-a7137e60.js";import"./index-10cac5b2.js";import"./index-91084da8.js";import"./index-1874b7a6.js";import"./useFlexGapSupport-6710d548.js";import"./jb4-8326f710.js";import"./gb28281-bff8df35.js";import"./index-4b48195f.js";import"./index-99ad184c.js";const v=_({name:"StreamPush"}),se=_({...v,setup(G){const{httpRefreshTime:f}=g({VITE_PORT:"3000",VITE_GLOB_APP_TITLE:"M7S_ADMIN",VITE_GLOB_APP_SHORT_NAME:"m7s_admin",VITE_USE_MOCK:"true",VITE_PUBLIC_PATH:"/admin",VITE_DROP_CONSOLE:"true",VITE_BUILD_COMPRESS:"none",VITE_BUILD_COMPRESS_DELETE_ORIGIN_FILE:"false",VITE_GLOB_HTTP_REFRESH_TIME:"5000",VITE_USE_IMAGEMIN:"true",VITE_LEGACY:"false",VITE_M7S_SERVER:"",BASE_URL:"/admin",MODE:"production",DEV:!1,PROD:!0,SSR:!1}),{pause:u,resume:c}=C(n,f);m.renderer.add("State",{renderDefault(e,o){const{row:t}=o;return M[t.state]}}),m.renderer.add("BPS",{renderDefault(e,o){const{row:t}=o;let s=0;return t.audioTrack&&(s=t.audioTrack.bps),t.videoTrack&&(s+=t.videoTrack.bps),`${B(s)}/s`}});const l=D(),E=e=>{e.length>1&&(e=e.sort((o,t)=>Date.parse(o.startTime)-Date.parse(t.startTime))),l.tableRef.reloadData(e)};async function n(){E(await L())}n(),I(e=>{});const T={maxHeight:"100%",rowConfig:{keyField:"path",useKey:!0},columnConfig:{useKey:!0},columns:[{field:"pluginName",title:"所属插件"},{field:"path",title:"StreamPath",showOverflow:"tooltip",minWidth:"250px"},{field:"state",title:"状态",showOverflow:"tooltip",cellRender:{name:"State"}},{field:"type",title:"类型",showOverflow:"tooltip"},{field:"subscribers",title:"订阅数量",showOverflow:"tooltip",width:"100px"},{field:"startTime",title:"创建时间",minWidth:"100px",formatter:({cellValue:e})=>y.toDateString(new Date(e),"yyyy-MM-dd HH:ss:mm")},{field:"BPS",title:"BPS",cellRender:{name:"BPS"}},{field:"operate",title:"操作",width:"120px",align:"center",slots:{default:"operate"}}],data:[]},S=P(),h=e=>{S(`/stream-push/detail/${encodeURIComponent(e)}`)};return(e,o)=>(O(),R(a(b),{bordered:!1,bodyStyle:{padding:"10px",height:"100%"},style:{height:"calc(100% - 100px)"}},{default:i(()=>[r(a(w),{windowWidth:1716}),r(a(V),{uid:a(l).uid,gridOptions:a(T)},{operate:i(({row:t})=>[r(a(x),null,{default:i(()=>[r(a(d),{size:"small",type:"link",onClick:()=>(a(k)({path:t.path,type:t.type},{onClose:a(c)}),a(u)())},{default:i(()=>[p(" 播放 ")]),_:2},1032,["onClick"]),r(a(d),{size:"small",type:"link",onClick:()=>h(t.path)},{default:i(()=>[p(" 详情 ")]),_:2},1032,["onClick"])]),_:2},1024)]),_:1},8,["uid","gridOptions"])]),_:1}))}});export{se as default};
